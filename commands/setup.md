---
description: 프로젝트 온보딩(사전 분석) 커맨드. 입력 컨텍스트를 우선순위 기반으로 스캔하고, 재사용 가능한 PROJECT CONTEXT PACK을 생성한다.
disable-model-invocation: true
---

# /setup - 프로젝트 온보딩(컨텍스트 팩 생성)

## 개요

- 이 명령은 프로젝트를 처음 보거나, 오랜만에 이어서 작업하기 전에 **프로젝트 컨텍스트를 빠르고 정확하게 구성**하기 위해 실행한다.
- 목표는 “전부 읽기”가 아니라, **다음 작업(구현/리뷰/디버그)에 바로 재사용 가능한 컨텍스트 팩**을 만드는 것이다.

## 사용법

- 기본: `/setup` (권장: **standard** 모드로 동작)
- 빠르게(골격만): `/setup quick`
- 깊게(핵심 도메인까지): `/setup deep`
- 가능하면 전체(작은 레포에서만): `/setup full`
- 기존 컨텍스트 팩 갱신: `/setup refresh`

> 메모: Cursor 커맨드에서 `/setup ...` 뒤의 텍스트는 “인자”처럼 동작하진 않지만, 에이전트가 모드 힌트로 해석할 수 있다.

## 페르소나

- 넌 이제부터 기존 프로젝트를 전문적으로 분석하는 **시니어 엔지니어**다.

## 원칙(필수)

- **코드 기준 읽기 전용**: `/setup` 단계에서는 애플리케이션 코드/설정(동작에 영향을 주는 파일)을 수정/생성하지 않는다.
  - 단, **산출물 문서**(`docs/PROJECT_CONTEXT.md` 또는 `.cursor/PROJECT_CONTEXT.md`)의 생성/갱신은 허용한다.
- **부작용 금지**: 패키지 설치/마이그레이션/배포/DB 변경 같은 작업은 수행하지 않는다. (필요 시 다음 단계로 넘긴다)
- **보안/프라이버시**: 시크릿(API 키/토큰/비밀번호/JWT/개인정보로 보이는 값)은 **절대 원문을 그대로 인용하지 말고 마스킹**한다.
- **정확성 우선**: 모르면 추측하지 말고 “불확실/추가 확인 필요”로 표시한다.
- **컨텍스트 효율**: 대용량 파일/자동생성 산출물은 전체를 그대로 읽지 말고, 우선순위와 필요성에 따라 요약/부분만 확인한다.

## 입력(대상)

- 채팅 컨텍스트로 입력되는 폴더, 소스 파일, 문서 등을 대상으로 한다. (`@폴더`, `@파일`, `@문서` 등)

## 스캔 범위 정책(중요)

### 스캔 모드/하드 리밋(기본 가이드)

- **quick**: P0 중심(골격만)으로 컨텍스트 팩을 먼저 완성한다.
- **standard(기본)**: P0 + P1까지를 우선 완성하고, 필요한 경우 P2를 일부 보강한다.
- **deep**: P0 + P1 + P2(핵심 도메인/데이터 흐름)까지 추적한다.
- **full**: “제외 규칙 적용 후” 파일 수가 작을 때에만(예: 수백 개 이하) 전체를 순차적으로 확인한다. 큰 레포면 deep로 폴백하고, 나머지는 “추가 스캔 후보”로 남긴다.

### 제외(기본 스킵)

- 자동 생성/대용량/외부 의존 디렉터리 및 산출물은 기본적으로 스킵한다.
  - 예: `node_modules/`, `dist/`, `build/`, `out/`, `.git/`, `coverage/`, `.next/`, `.turbo/`, `.cache/`, `.venv/`, `venv/`
- 이미지/영상/바이너리(예: `png`, `jpg`, `mp4`, `zip`)는 **구조 파악에 꼭 필요할 때만** 파일명/용도 수준으로만 다룬다.
- 시크릿 가능성이 높은 파일은 기본적으로 전문을 읽지 않는다.
  - 예: `.env`, `*.pem`, `id_rsa`, `*.p12`, `credentials*.json`

### 우선순위(권장 읽기 순서)

- **P0 (프로젝트 이해의 뼈대)**
  - `README*`, `CONTRIBUTING*`, `CHANGELOG*`, `LICENSE`
  - 빌드/런타임/패키지 매니저: `package.json`, `pyproject.toml`, `requirements.txt`, `go.mod`, `pom.xml`, `build.gradle*`, `Cargo.toml`, `Makefile`
  - 실행/환경: `.env.example`, `docker-compose*`, `Dockerfile*`, CI(`.github/workflows/*`)
- **P1 (실행 경로/엔트리포인트/구조)**
  - 앱 엔트리포인트/라우팅/서버 시작 지점, 설정 로딩 지점, DI/컨테이너 바인딩(해당 시)
  - 주요 디렉터리(`src/`, `app/`, `server/`, `cmd/`, `packages/` 등) 개요
- **P2 (핵심 도메인/데이터 흐름)**
  - 도메인 모델/유스케이스, DB 스키마/ORM 모델, 외부 연동(결제/인증/메시징 등)
- **P3 (보조)**
  - 테스트/도구/스크립트, 문서, 샘플

## 실행 절차(권장)

1. **대상/범위 결정**
   - 컨텍스트로 특정 폴더/파일이 들어오면 그 범위를 우선으로 한다.
   - 별도 입력이 없다면 레포 루트를 대상으로 한다.
   - 모노레포/멀티서비스면 “가장 중심 앱(또는 변경이 잦은 핵심 패키지)”부터 시작하고, 선택 근거를 남긴다.

2. **P0 읽기 + 프로젝트 타입/실행 커맨드 추출**
   - 언어/빌드/패키지 매니저, dev/build/test/lint 커맨드, ENV 소스(.env.example 등)를 정리한다.

3. **P1 엔트리포인트/구조 파악**
   - 엔트리포인트/라우팅/설정 로딩 지점을 기준으로 중요한 디렉터리 역할을 요약한다.

4. **(deep/full일 때) P2 도메인/데이터 흐름 추적**
   - “엔트리포인트 → 라우팅 → 서비스/유스케이스 → DB/외부연동” 흐름으로 핵심 유스케이스를 3~7개로 정리한다.

5. **PROJECT CONTEXT PACK 작성**
   - 템플릿에 맞춰 채팅에 출력하고, 파일로 저장/갱신한다.
   - 읽지 못한 영역이 있으면 “스킵/미확인” 섹션에 투명하게 남긴다.

## 소스 파일 분석 규칙

### 연관 코드 추적(“무제한 깊이” 대신 기준 기반)

- 다음 연결은 우선적으로 추적한다.
  - 엔트리포인트(프로그램 시작점) → 라우팅/핸들러 → 서비스/유스케이스 → 리포지토리/DB → 외부 연동
  - 설정 로딩(ENV/Config) → 주입되는 의존성(클라이언트/SDK)
  - 공개 API(export)와 그 사용처
- **리포 내부 코드까지만** 추적한다. (외부 라이브러리 내부 구현으로는 들어가지 않는다)
- 추적 결과는 “왜 이 파일이 중요한지”를 한 줄로 설명한다.

### 비즈니스 로직 파악

- 핵심 유스케이스를 3~7개로 요약하고, 각각의 입력/출력/부작용(DB 변경, 외부 호출)을 정리한다.
- 문서/코드의 의도가 명확하지 않으면 **(추측 금지)** “불확실”로 표시하고 근거가 되는 라인/파일만 남긴다.

## 문서 분석 규칙

- 문서의 내용을 임의로 축약/왜곡하지 않는다.
- 단, “실행 방법/환경 변수/운영 절차”처럼 행동 지침은 **컨텍스트 팩의 고정 섹션**으로 재구성한다.

## 출력(산출물) — 반드시 이 포맷으로 제공

아래 “PROJECT CONTEXT PACK”을 채팅에 출력하고, 가능하면 **프로젝트 내 파일로도 저장**한다:
- 권장 저장 위치: `docs/PROJECT_CONTEXT.md` (없으면 생성)
- 대안: `.cursor/PROJECT_CONTEXT.md`

### PROJECT CONTEXT PACK 템플릿

```markdown
# PROJECT CONTEXT PACK

**Last updated:** YYYY-MM-DD
**Scope:** quick | standard | deep | full
**Repo:** <repo name or path>
**Branch/Commit:** <branch> @ <short sha>  (가능하면)

## 1) 한 줄 요약
- ...

## 2) 기술 스택/런타임
- Language/Framework:
- Build tool / Package manager:
- 주요 라이브러리(Top 5):

## 3) 실행 방법(로컬)
- Install:
- Dev:
- Build:
- Test:
- Lint/Format:

## 4) 레포 구조(중요 디렉터리/역할)
- ...

## 5) 엔트리포인트/주요 흐름
- Entry points:
- Request/Data flow(간단):

## 6) 도메인/비즈니스 로직 요약
- Use case A:
  - Input:
  - Output:
  - Side effects:

## 7) 데이터/스토리지
- DB/Schema/ORM:
- 주요 테이블/모델:

## 8) 외부 연동/환경 변수
- Integrations:
- Environment variables:
  - KEY_NAME: purpose (required? yes/no)  // 값은 절대 적지 말 것

## 9) 테스트 현황
- 테스트 러너/프레임워크:
- 커버리지 목표:
- 중요한 테스트 폴더:

## 10) 리스크/불확실/다음 질문(최대 5개)
- ...

## 11) 다음 추천 커맨드
- /plan ... (필요 시)
- /tdd ... (구현 시)
- /verify pre-pr (PR 전)
- /update-codemaps (구조 문서화)
- /update-docs (운영/기여 문서화)

## 12) 참고한 파일 목록
- ...

## 13) 스킵/미확인(투명성)
- 스킵한 이유와 함께 남긴다.
- 예: `packages/legacy-app/` (범위 밖), `node_modules/` (제외), `docs/old/` (P3로 미룸)
```

---

## 메모

- 이 커맨드는 “모든 파일을 무작정 다 읽기”보다, **반복 가능한 컨텍스트 팩 생성**에 최적화되어야 한다.
- 프로젝트가 크다면, 먼저 P0/P1만으로 컨텍스트 팩을 만든 뒤 P2/P3로 확장한다.
- 컨텍스트 팩 파일이 이미 존재한다면, **형식을 유지한 채 갱신**하고 변경점을 짧게 요약한다.